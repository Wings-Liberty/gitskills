this is modified by changxu.